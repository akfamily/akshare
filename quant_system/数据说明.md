# 📊 数据说明

## 当前数据状态

### ⚠️ 重要说明

**系统目前使用的是模拟数据！**

为了让你能快速体验系统功能，我在以下地方使用了随机生成的模拟数据：

1. **基钦周期分析**
   - 需求增速：`np.random.uniform(-3, 8)` （随机-3%到8%）
   - 库存增速：`np.random.uniform(-5, 5)` （随机-5%到5%）
   - PMI指标：随机48-55

2. **朱格拉周期分析**
   - 固定资产投资增速：随机-2%到10%
   - PPI同比：随机-3%到8%
   - 产能利用率：随机70%-85%

3. **市场情绪分析**
   - 估值得分：随机20-80
   - 情绪得分：随机20-80
   - 流动性得分：随机20-80
   - 市场宽度得分：随机20-80

## 🔄 如何使用真实数据？

### 方法1：下载历史数据（推荐）

```bash
# 在 quant_system 目录下运行
python3 scripts/download_data.py
```

**这会做什么？**
- 从AKShare下载真实的宏观数据（GDP、CPI、PPI、PMI、M2、社融）
- 下载市场数据（指数行情、个股数据）
- 下载行业分类、估值数据、资金流向
- 保存到 `data/cache/` 目录
- 大约需要10-30分钟（取决于网络速度）

**下载完成后：**
- 系统会优先使用缓存的真实数据
- 数据每周自动检查新鲜度
- 如果缓存失效，会自动降级到模拟数据

### 方法2：修改代码使用实时数据

找到对应的周期分析文件，修改获取数据的方法：

**示例**（`analysis/cycle/kitchin.py`）：

```python
# 原来（模拟数据）
def _get_inventory_growth(self) -> float:
    return np.random.uniform(-5, 5)

# 修改后（真实数据）
def _get_inventory_growth(self) -> float:
    from data.data_loader import get_data_loader
    loader = get_data_loader()
    pmi_data = loader.get_macro_data('pmi')
    # 解析PMI产成品库存指数...
    return actual_value
```

## 📋 数据源对照表

| 指标 | 模拟数据范围 | 真实数据来源 | AKShare接口 |
|------|-------------|-------------|-------------|
| CPI | 98-103 | 国家统计局 | `macro_china_cpi()` |
| PPI | 95-107 | 国家统计局 | `macro_china_ppi()` |
| PMI | 48-52 | 国家统计局 | `macro_china_pmi()` |
| GDP | 4-7% | 国家统计局 | `macro_china_gdp()` |
| M2 | 8-12% | 央行 | `macro_china_money_supply()` |
| 社融 | - | 央行 | `macro_china_shrzgm()` |

## 🎯 为什么用模拟数据？

### 优点
1. ✅ **即开即用** - 不需要等待数据下载
2. ✅ **离线运行** - 没网也能演示
3. ✅ **快速调试** - 开发测试更方便
4. ✅ **避免限制** - 不受API频率限制

### 缺点
1. ❌ **不准确** - 随机数据，不反映真实市场
2. ❌ **每次变化** - 刷新后数据改变
3. ❌ **无法回测** - 没有历史连续性

## 🔮 真实数据 vs 模拟数据

### 使用模拟数据时（当前状态）

**适合场景**：
- 🎓 学习系统功能
- 🔬 测试代码逻辑
- 🎨 演示界面效果
- 🚀 快速上手体验

**不适合场景**：
- ❌ 实际投资决策
- ❌ 历史回测
- ❌ 策略验证

### 使用真实数据后

**适合场景**：
- ✅ 分析真实市场
- ✅ 投资决策参考
- ✅ 历史回测验证
- ✅ 策略优化

## 🚀 快速切换到真实数据

### 一键下载真实数据

```bash
# 1. 进入目录
cd ~/Documents/akshare/quant_system

# 2. 下载数据（首次需要10-30分钟）
python3 scripts/download_data.py

# 3. 重启Web界面
streamlit run web_app.py
```

下载完成后，系统会自动使用真实数据！

### 检查数据状态

```python
# 在Python中运行
from data.data_loader import get_data_loader

loader = get_data_loader()
status = loader.check_cache_status()

print(f"是否有缓存: {status['has_cache']}")
print(f"下载日期: {status['download_date']}")
print(f"数据天数: {status['age_days']}")
print(f"是否新鲜: {status['is_fresh']}")
```

## 📊 数据更新频率建议

| 数据类型 | 更新频率 | 说明 |
|---------|---------|------|
| 宏观数据 | 每月一次 | GDP、CPI、PPI等按月公布 |
| 市场数据 | 每周一次 | 指数、行情等 |
| 行业数据 | 每季度一次 | 行业分类变化不频繁 |
| 资金数据 | 每周一次 | 北向资金、融资融券等 |

## ⚡ 性能对比

| 操作 | 模拟数据 | 缓存真实数据 | 实时获取 |
|------|---------|------------|----------|
| 首次启动 | < 1秒 | < 2秒 | 10-30秒 |
| 刷新页面 | < 1秒 | < 2秒 | 5-10秒 |
| 生成报告 | < 2秒 | < 3秒 | 30-60秒 |

## 💡 最佳实践

### 日常使用建议

1. **首次使用**：运行 `python3 scripts/download_data.py` 下载真实数据
2. **每周更新**：重新运行下载脚本，更新最新数据
3. **快速演示**：使用模拟数据即可
4. **正式分析**：必须使用真实数据

### 数据验证

```bash
# 查看缓存的数据文件
ls -lh data/cache/

# 应该看到：
# macro_data.pkl      - 宏观数据
# market_data.pkl     - 市场数据
# industry_data.pkl   - 行业数据
# valuation_data.pkl  - 估值数据
# fund_data.pkl       - 资金数据
# last_download.pkl   - 下载记录
```

## 🆘 常见问题

### Q1: 为什么每次刷新数据都变？

**A**: 因为使用的是随机生成的模拟数据。运行 `python3 scripts/download_data.py` 下载真实数据后就不会变了。

### Q2: 下载数据失败怎么办？

**A**: 可能原因：
- 网络问题：检查网络连接
- API限制：等待几分钟后重试
- 权限问题：确保有写入 `data/cache/` 的权限

**解决方案**：系统会自动降级到模拟数据，不影响使用

### Q3: 如何强制刷新缓存？

**A**:
```bash
# 删除旧缓存
rm -rf data/cache/*

# 重新下载
python3 scripts/download_data.py
```

### Q4: 缓存占用多少空间？

**A**: 约50-200MB（取决于下载的数据年限）

---

**总结：系统现在用的是模拟数据，运行下载脚本后会自动切换到真实数据！** 🎯
